# ネットワーキングとコンテンツ配信
## 1. AWSのネットワーキングとコンテンツ配信に関するサービス
AWSのネットワークやコンテンツ配信・AWS環境への接続設定に利用するサービスとしては以下のようなものがあります。

| サービス名          | 説明                                                                                                                                   |
| ------------------- | -------------------------------------------------------------------------------------------------------------------------------------- |
| Amazon VPC          | IPアドレス範囲の選択、サブネットの作成、ルートテーブルやネットワークゲートウェイの設定など、仮想ネットワーキング環境を構築するサービス |
| Amazon CloudFront   | 低レイテンシーの高速転送により世界中の視聴者に安全に配信する高速コンテンツ配信ネットワーク (CDN) サービス                              |
| Amazon Route53      | DNSサーバーの機能を提供し、ドメイン変換とルーティングを実施するサービス                                                                |
| AWS Direct Connect  | AWS とデータセンター、オフィス、またはコロケーション環境との間にプライベート接続を確立する専用線サービス                               |
| Amazon API Gateway  | リアルタイム双方向通信アプリケーションを実現する RESTful API および WebSocket API を作成・管理する                                     |
| AWS Storage Gateway | オンプレミスから実質無制限のクラウドストレージへのアクセスを提供するハイブリッドクラウドストレージサービス                             |
## 2. CloudFront
### 2-1. CloudFrontとは
CloudFrontはAWSが提供するCDN（Content Delivery Network）サービスです。  
CDNサービスはWebコンテンツの配信処理を高速化するためのサービスで、動画や音声などの大容量のデータを配信したり、ソーシャルゲームの初回ダウンロードのように大量のデータを配信したりする際によく利用されます。  

![](../../aws_cp_networking_and_contents_delivery_cloudfront_image.png)
CloudFrontの仕組みは、図のように世界の各地にエッジサーバーと呼ばれる配信拠点があり、ユーザーはそのエッジサーバーにアクセスをします。  
エッジサーバーはユーザーからのリクエストを受けてオリジンと呼ばれる実際にデータが配置されているサーバーもしくはS3からデータを取得してきてユーザーに配信します。  
また、その際にエッジサーバーはデータをキャッシュするため、一度オリジンから取得したデータであれば再度オリジンに取りに行くこと無くエッジサーバーがデータを配信することができます。  
そのため例えば図のように日本にオリジンのサーバーが配置されていて、アメリカやヨーロッパからリクエストがあった場合に、ユーザーから地理的に近いエッジサーバーからキャッシュしたデータを配信できるため非常に高速に配信を行えます。
### 2-2. CloudFrontの特徴
CloudFrontは大規模なアクセスも世界中にあるエッジのキャパシティを活用して、効率的かつ高速にコンテンツ配信が可能なサービスです。  
特徴としては以下のようなものがあります。
- 200以上のエッジサーバによる高性能な分散配信
- 高いパフォーマンス
- AWS WAF／AWS Shield／AWS Certificate Managerとの連携やDDoS対策によるセキュリティ機能
- オリジンに対してHeader／Cookie／Query Stringsによるフォワード指定で、動的なページ配信が可能
## 3. Direct Connect
### 3-1. Direct Connectとは
Direct Connectとはお客様のデータセンターやオフィスを専用線などを介してAWSへプライベートに接続できるサービスです。  
Direct Connectのメリットには以下のようなものがあります。
- 安価なアウトバウンドトラフィック料金
- ネットワーク信頼性の向上
- ネットワーク帯域幅の向上
### 3-2. Direct Connectの特徴
Direct Connectの特徴は同じような目的が実現できるVPNと比較して以下のようになります。  
大まかにまとめると、VPNのほうが安く素早く利用ができますが、信頼性や品質に関してはDirect Connect（専用線）のほうが勝る、というような形になります。

| 項目         | VPN                                                                | Direct Connect<br/>（専用線）                       |
| ------------ | ------------------------------------------------------------------ | --------------------------------------------------- |
| コスト       | 安価なベストエフォート回線が利用可能                               | キャリアの専用線サービス契約が必要となりVPNより割高 |
| リードタイム | クラウド上での接続設定で可能なため即時                             | 物理対応が必要なため数週間                          |
| 帯域幅       | 暗号化のオーバーヘッドにより制限がある                             | ポートあたり1G/10Gbps                               |
| 品質         | インターネット経由のためネットワーク状態の影響を受ける             | キャリアにより高い品質が保証される                  |
| 障害切り分け | インターネットベースのため自社で保持している範囲以外の確認は難しい | 物理的に経路が確保されているため比較的容易          |
## 4. API Gateway
### 4-1. API Gatewayとは
API GatewayとはAPIの作成・管理をフルマネージド型で提供しているAWSサービスです。  
特徴としては以下のようなものがあります。
- 最大数十万個のAPI同時呼び出し・受付が可能
- アクセス制御の管理
- DDoS攻撃対応やスロットリングによるバックエンド保護
- EC2／Lambda／任意のウェブアプリケーションのワークロード処理を実行する
- Lambdaと密接に統合されている
- WebSocketを利用したリアルタイムかつ双方向通信のAPIも処理可能（2019年より）
### 4-2. APIとは
![](../../aws_cp_networking_and_contents_delivery_api_image.png)
APIとは、APIを通してリクエストとレスポンスにより、他サービスの機能やデータを呼び出すことができる機能です。  
専門的には、
- APIはアプリケーションソフトウェア開発に利用される標準的なインター
フェース群のこと
- 中でもWEB APIはWEB上で他のサービスを呼び出す方式や取り決め

というものになります。
### 4-3. API Gatewayのユースケース
![](../../aws_cp_networking_and_contents_delivery_usecase_image.png)
API Gatewayのユースケースとしては外部のWebアプリなどからAPI Gatewayを連携口として、Lambdaや他のAWSサービスとの連携を実現するというものがあります。
## 5. AWS Storage Gateway
### 5-1. AWS Storage Gatewayとは
![](../../aws_cp_networking_and_contents_delivery_storagegateway_image.png)
AWS Storage Gatewayとは標準的なストレージプロトコルを利用して外部システム環境とAWSのストレージサービスとを接続するサービスです。
### 5-2. AWS Storage Gatewayの利点
AWS Storage GatewayはAWSが有する機能や性能を活用できることが大きな利点ですが、具体的には以下のようなものになります。
- 標準的なストレージプロトコルを活用したシームレスな統合
- キャッシュを活用した低レイテンシーなアクセスが可能
- AWSストレージサービスの堅牢性・低コスト・拡張性
- 効率的なデータ転送
- AWSのモニタリング・管理・セキュリティとの統合
### 5-3. AWS Storage Gatewayの用途
AWS Storage Gatewayはデータ移転や保存などAWSストレージを利用したい場合に用いますが、具体的には以下のようなケースがあります。
- ビッグデータ処理／クラウドバースティング／システム移行のためにデータをAWSストレージに移動させたいケース
- バックアップ・アーカイブ・災害対策としてAWSにデータを保持
- オンプレミス環境で容易にAWSストレージを活用
### 5-4. Storage Gatewayのタイプ
Storage Gatwayには４つのタイプがありますが、利用するデータタイプに応じてそれぞれ利用します。

| ゲートウェイ名                     | 説明                                                                                                                         |
| ---------------------------------- | ---------------------------------------------------------------------------------------------------------------------------- |
| ファイルゲートウェイ               | Amazon S3 オブジェクトにStorage Gatewayを経由してファイルデータを格納                                                        |
| キャッシュ型ボリュームゲートウェイ | 頻繁にアクセスされるデータはローカルのストレージゲートウェイに保持しながら、Amazon S3 をプライマリデータストレージとして使用 |
| 保管型ボリュームゲートウェイ       | 保管型ボリュームを使用すると、プライマリデータをローカルに保存する一方で、そのデータを非同期に AWS にバックアップ            |
| テープゲートウェイ                 | Amazon S3 と Glacierにデータを保管する仮想テープストレージとVTL管理                                                          |