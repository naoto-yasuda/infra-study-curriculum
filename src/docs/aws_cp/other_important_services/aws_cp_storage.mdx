# ストレージ
## 1. AWSのストレージサービス
AWSにはデータを保存する際に利用できる多様なストレージサービスがあります。  
代表的なものとしては以下のとおりです。

| サービス名 | 説明 |
|-------|-------|
| Amazon Simple Storage Service<br/>(S3) | スケーラビリティ、データ可用性、セキュリティ、およびパフォーマンスを提供するオブジェクトストレージサービス |
| Amazon Elastic Block Store<br/>(EBS) | EC2にアタッチして利用する専用のブロックストレージ |
| Amazon Elastic File System<br/>(EFS) | AWSクラウドサービスおよびオンプレミスリソースで使用するための、シンプルでスケーラブル、かつ伸縮自在な完全マネージド型の NFS ファイルシステム |
| Amazon S3 Glacier | 安全性と耐久性に優れ、きわめて低コストの Amazon S3クラウドストレージクラスで、データのアーカイブや長期バックアップに使用する |
## 2. Amazon Elastic File System
### 2-1. Amazon Elastic File Systemとは
Amazon Elastic File System（EFS）とは複数のEC2インスタンスからアクセス可能な共有ストレージのサービスです。  
同じストレージサービスであるS3、EBSと比較すると以下のような違いがあります。
#### 2-1-1. S3
- オブジェクトストレージでリージョンに設置
- HTTPによるAPI経由でアクセス
- 大容量のデータを長期保存するためのもの
#### 2-1-2. EBS
- ブロックストレージでAZに設置
- EC2インスタンスのディスクボリュームとして利用するが、物理的ではなくネットワーク経由で利用
- 複数のEC2インスタンスにアタッチできない
#### 2-1-3. EFS
- NASに似たファイルストレージ
- ファイルシステムとして利用し、複数のEC2インスタンスでの共有アクセスが可能
- S3と異なりインターネットから直接アクセスができない
### 2-2. EFSの特徴
EFSの特徴はシンプルでスケーラブルで柔軟に利用できるファイルストレージであることです。  
それぞれの特徴を深堀りすると以下のようなものがあります。
#### 2-2-1. シンプル
- フルマネージド型サービス
- 既存のNFSv4などのツールや標準プロトコル／APIでアクセス可能
#### 2-2-2. スケーラブル
- ペタバイトまでスケーラブルにデータを蓄積
- スループット／IOPS性能は自動的にスケーリングし、低レイテンシーを維持
#### 2-2-3. 柔軟性
- ファイルの減少に合わせて自動で拡張・縮小
- 事前に容量を設定する必要なし
- 使った分だけの従量課金
## 3. Amazon S3 Glacier
### 3-1. Amazon S3 Glacierとは
Glacierはバックアップなどの中長期保存用の用途に適した、S3よりも安価なストレージサービスです。  
S3に比べてデータ取得などの迅速性が無い代わりに、S3と同じ耐久性でありながらS3よりも値段が安いものになっています。
### 3-2. Glacierの特徴
Glacierには以下のような特徴があります。
- Amazon S3 Glacier では、データは「アーカイブ」に保存される
- １つのアーカイブの最大サイズは40TB
- 保存可能なアーカイブ数とデータ量に制限なし
- 各アーカイブには作成時に一意のアーカイブIDが割り当てられ、作成後はアーカイブを更新できない。
- アーカイブを保存するためのコンテナとして「ボールト」を使用（１つのAWSアカウントでは、最大1,000個のボールトを使用）
- Amazon S3のライフサイクルルールと連携させることにより、Amazon S3データのアーカイブを自動化し、全体的なストレージコストを削減
- Advanced Encryption Standard (AES) 256 ビット対称鍵を使用してデフォルトで自動的に暗号化
- S3と違って直接データをアップロード・取得という処理ができないため、S3ライフサイクル管理からか、プログラム処理によるアップロード／ダウンロードが必要
- Glacierの最低保持期間は90日
### 3-3. Glacierのデータ取出タイプ
Glacierには複数のデータ取得タイプが有り、取得タイプの設定に応じてデータ取得時間と取得時の料金が変わってきます。

| タイプ | 特徴 |
|-------|-------|
| 迅速 | ・迅速取り出しでは、アーカイブのサブセットが迅速に必要になった場合にデータにすばやくアクセスするモード<br/>・通常 1～5 分以内で使用可能になる |
| プロビジョニングキャパシティ | ・プロビジョンドキャパシティーは、迅速取り出しの取得容量を必要なときに利用できることを保証する仕組み |
| 標準 | ・標準取り出しでは、数時間以内にすべてのアーカイブにアクセスできるデフォルト設定<br/>・通常、標準取り出しは 3～5 時間で完了 |
| 大容量 | ・大容量取り出しは、最も安価な取り出しオプションであり、大量のデータ (ペタバイトのデータを含む) を 1 日以内に低コストで取得できます<br/>・通常、大容量取り出しは 5～12 時間で完了 |
## 4. Glacier Deep Archive
### 4-1. Glacier Deep Archiveとは
Glacier Deep ArchiveとはGlacierよりも更に安価にデータを保存することが可能ですが、データ取得はGlacierより更に遅くなる中長期保存用のストレージタイプです。
### 4-2. Glacier Deep Archiveの特徴
Glacier Deep Archiveには以下のような特徴があります。
- 基本的なデータモデル・管理はGlacierと同じ
- 1 GB あたりの月額料金 0.00099 USD から利用可能でAWSの最低価格
- データは 3 つ以上の AWS アベイラビリティゾーンにまたがって保存され、S3と同様に99.999999999% の耐久性を実現
- 標準取り出しで、データは12 時間以内に取りだすことが可能
- 大量取り出しで、48 時間以内にデータを取り出す大容量取り出しをすることで取得コストを低減できる
## 5. ユースケース分け
各ストレージサービスのユースケースに応じた使い分けを理解して、実際の試験問題に対応できるようにしましょう。

| サービス名 | 説明 |
|-------|-------|
| Amazon Simple Storage Service<br/>(S3) | インターネットアクセス／EC2インスタンス間で共有／大量データを保存したいケースは基本はS3を利用する。 |
| Amazon Elastic Block Store<br/>(EBS) | EC2インスタンスにアタッチして、アプリケーションを構成するためのボリュームディスクとして利用する場合はEBSを利用 |
| Amazon Elastic File System<br/>(EFS) | インターネットアクセスは不可で、EC2インスタンス間でのデータ共有をする場合はEFSを共有ストレージとして利用 |
| Amazon S3 Glacier | データバックアップなど中長期にアクセス頻度が低いデータを保存する場合にコスト最適を目指してGlacierを選択する |