# コマンド操作の学習「top」
topコマンドは現在実行中のプロセスの情報を表示するためのコマンドです。  
初期表示はCPU使用率が高い順に並んで表示されています。
## 1. 基本コマンド
現在実行中のプロセスの情報をただ表示したい場合は下記のコマンドで表示することができます。
```shell
top

※実行結果例
top - 16:06:12 up 274 days, 21:55,  1 user,  load average: 0.00, 0.00, 0.00
Tasks:  86 total,   1 running,  47 sleeping,   0 stopped,   0 zombie
%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem :   470124 total,   166420 free,   100960 used,   202744 buff/cache
KiB Swap:        0 total,        0 free,        0 used.   357120 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0  125640   3756   2176 S   0.0  0.8   7:15.13 systemd
    2 root      20   0       0      0      0 S   0.0  0.0   0:03.67 kthreadd
    4 root       0 -20       0      0      0 I   0.0  0.0   0:00.00 kworker/0:+
    6 root       0 -20       0      0      0 I   0.0  0.0   0:00.00 mm_percpu_+
    7 root      20   0       0      0      0 S   0.0  0.0   0:35.32 ksoftirqd/0
    8 root      20   0       0      0      0 I   0.0  0.0   2:49.04 rcu_sched
～　省略　～
```
通常のコマンドと違いtopコマンドは継続して実行され３秒毎に表示内容が更新されます。  
表示を終了したい場合は「q」を入力することで終了することができます。  
「h」を入力することでヘルプを表示することができます。
実行結果に表示される内容の左側の番号は管理番号で、基本的にはこの順番で入力されていることを指す番号になります。
### プロセス表示の見方について
プロセス表示の見方は以下の通りです。
```
top - 16:06:12 up 274 days, 21:55,  1 user,  load average: 0.00, 0.00, 0.00
１行目：左から現在時刻、システムが起動してからの稼働時間、ログインしているユーザ数、
　　　　CPUの平均負荷率（１分間、５分間、１５分間）

Tasks:  86 total,   1 running,  47 sleeping,   0 stopped,   0 zombie
２行目：タスクまたはスレッドの数

%Cpu(s):  0.0 us,  0.0 sy,  0.0 ni,100.0 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
３行目：CPU使用状況の割合

KiB Mem :   470124 total,   166420 free,   100960 used,   202744 buff/cache
４行目：メモリ使用状況

KiB Swap:        0 total,        0 free,        0 used.   357120 avail Mem
５行目：スワップメモリ使用状況

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
    1 root      20   0  125640   3756   2176 S   0.0  0.8   7:15.13 systemd
    2 root      20   0       0      0      0 S   0.0  0.0   0:03.67 kthreadd
    4 root       0 -20       0      0      0 I   0.0  0.0   0:00.00 kworker/0:+
    6 root       0 -20       0      0      0 I   0.0  0.0   0:00.00 mm_percpu_+
    7 root      20   0       0      0      0 S   0.0  0.0   0:35.32 ksoftirqd/0
    8 root      20   0       0      0      0 I   0.0  0.0   2:49.04 rcu_sched

各列の意味は以下の通り
・PID：プロセスID
・USER：ユーザー名
・PR：優先度（プライオリティ）
・NI：nice値
・VIRT：仮想メモリの総量
・RES：常駐サイズ（kb）
・SHR：共有メモリサイズ（kb）
・S：プロセス状態
・%CPU：CPU利用率
・%MEM：メモリー利用量
・TIME：CPU利用時間
・COMMAND：コマンドライン
```
## 2. 便利なtopコマンドのインタラクティブコマンド
### 2-1. xコマンド：現在のソートに利用されている項目をハイライト表示する
topコマンドによるプロセス表示中にxコマンドを押すと現在のソートに利用している項目をハイライト表示することができます。
### 2-2. <コマンド、>コマンド：ソートに利用する項目を変更する
「<」もしくは「>」によってソートに利用する項目を左右に切り替えることができます。
### 2-3. Rコマンド：ソート順を逆順に変更する
rコマンドによってソート順を逆に変更することができます。
### 2-4. Eコマンド、eコマンド：メモリ使用状況もしくはタスク一覧のメモリ情報の単位を変更する
Eコマンドでメモリ使用状況のメモリ情報の単位を変更することができます。  
eコマンドでタスク一覧のメモリ情報の単位を変更することができます。  
デフォルトがKB（キロバイト）で、一度コマンドを押す毎にMB（メガバイト）、GB（ギガバイト）、TB（テラバイト）、PB（ペタバイト）と切り替えられます。
### 2-5. mコマンド：メモリ使用状況の表示を切り替える
mコマンドでメモリ使用状況の表示を切り替え、割合による表示に切り替えることができます。
## 3. 便利なtopコマンドのオプション
### 3-1. -dオプション：更新する間隔を指定する
-dオプションを利用することで表示が更新される間隔を指定することができます。
```shell
例：１秒毎に表示を更新したい場合
top -d 1
```
### 3-2. -nオプション：表示を繰り返す回数を指定する
-nオプションを利用することで表示を繰り返す回数を指定することができます。
```shell
例：１０回表示を更新したい場合
top -n 10
```

## 4. 学習用サーバーに接続して、実際にコマンドを試してみましょう
[リンク](https://bellard.org/jslinux/)を開いて、「x86 Alpine Linux 3.12.0 Console」の「click here」をクリックしましょう。  
出てきたコンソール画面に対してコマンドを入力してみてください。  
上手くいかない時は教育担当までご連絡をお願いします。